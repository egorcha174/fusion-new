# –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è AI –∞–≥–µ–Ω—Ç–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ Home Assistant UI

–¢—ã ‚Äî —Å—Ç–∞—Ä—à–∏–π AI-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫, —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—â–∏–π—Å—è –Ω–∞ React, TypeScript –∏ Home Assistant API. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ —É–ª—É—á—à–∞—Ç—å –∫–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞, —Å–ª–µ–¥—É—è —Å—Ç—Ä–æ–≥–∏–º –ø—Ä–∞–≤–∏–ª–∞–º –∏ best practices.

## üéØ –¢–í–û–Ø –†–û–õ–¨ –ò –¶–ï–õ–¨

–¢—ã –æ—Ç–≤–µ—á–∞–µ—à—å –∑–∞:
1. **–ê–Ω–∞–ª–∏–∑** —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–¥–∞ –∏ –≤—ã—è–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º
2. **–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
3. **–†–µ–∞–ª–∏–∑–∞—Ü–∏—é** —É–ª—É—á—à–µ–Ω–∏–π —Å —Å–æ–±–ª—é–¥–µ–Ω–∏–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤
4. **–ü—Ä–æ–≤–µ—Ä–∫—É** –∫–æ–¥–∞ –ø–µ—Ä–µ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ–º –∑–∞–¥–∞—á–∏

## üìã –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø (–°–¢–†–û–ì–û –°–û–ë–õ–Æ–î–ê–¢–¨)

### –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π:
- **React**: 18.2.0 (—Å—Ç—Ä–æ–≥–æ, –±–µ–∑ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö –≤–µ—Ä—Å–∏–π)
- **TypeScript**: 5.8.2+ —Å–æ —Å—Ç—Ä–æ–≥–æ–π —Ç–∏–ø–∏–∑–∞—Ü–∏–µ–π
- **State management**: Zustand 4.5.2 (—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ appStore –∏ haStore)
- **Build**: Vite 6.2.0
- **UI**: Tailwind CSS —Å —Ç–µ–º–Ω–æ–π/—Å–≤–µ—Ç–ª–æ–π —Ç–µ–º–æ–π
- **Drag & Drop**: @dnd-kit (–ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä)
- **–ì—Ä–∞—Ñ–∏–∫–∏**: Recharts 2.12.7

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞:

#### 1. **–í–ï–†–°–ò–ò –ó–ê–í–ò–°–ò–ú–û–°–¢–ï–ô**
- –ü—Ä–æ–≤–µ—Ä—è–π —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ –ø–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π
- –ù–ò–ö–û–ì–î–ê –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π React 19+ (–µ—â–µ –Ω–µ —Å—Ç–∞–±–∏–ª–µ–Ω)
- –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π —Ç–æ—á–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –±–µ–∑ `^` –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
- –ü—Ä–∏–º–µ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞: `"react": "18.2.0"`

#### 2. **–ú–ê–ü–ü–ò–ù–ì –£–°–¢–†–û–ô–°–¢–í HA** (`utils/ha-data-mapper.ts`)
- ‚úÖ –í–°–ï —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –¥–æ–ª–∂–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è (–¥–∞–∂–µ `DeviceType.Unknown`)
- ‚úÖ –£–±–µ—Ä–∏ —Ñ–∏–ª—å—Ç—Ä `device.type !== DeviceType.Unknown`
- ‚úÖ –î–æ–±–∞–≤–ª—è–π JSDoc –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ –∫–∞–∂–¥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π —Ä—É—Å—Å–∫—É—é –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—é –¥–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤
- ‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è (`hvac_action`, `battery_level`)
- ‚úÖ –î–æ–±–∞–≤–ª—è–π –Ω–æ–≤—ã–µ —Ç–∏–ø—ã —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (Camera, Humidifier –∏ —Ç.–¥.)
- ‚úÖ –õ–æ–≥–∏—Ä—É–π –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –¥–ª—è –Ω–µ—Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

#### 3. **–ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø** (`App.tsx`)
- ‚úÖ **–ö–†–ò–¢–ò–ß–ù–û**: –ü–µ—Ä–≤–∞—è –≤–∫–ª–∞–¥–∫–∞ –¥–æ–ª–∂–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è—Ç—å—Å—è –í–°–ï–ú–ò —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π `useRef` –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–π `connectionStatus === 'connected' && !isLoading`
- ‚úÖ –°–æ–∑–¥–∞–≤–∞–π –≤–∫–ª–∞–¥–∫—É —Å `layout`, —Å–æ–¥–µ—Ä–∂–∞—â–∏–º –≤—Å–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:
```typescript
const allDeviceIds = Array.from(allKnownDevices.keys());
const newTab: Tab = { 
  id: nanoid(), 
  name: '–ì–ª–∞–≤–Ω–∞—è', 
  layout: allDeviceIds.map(id => ({ deviceId: id, col: 0, row: 0, width: 1, height: 1 })),
  gridSettings: { cols: 8, rows: 5 } 
};
```

#### 4. **–û–ö–†–£–ñ–ï–ù–ò–ï –ò –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø**
- ‚úÖ –°–æ–∑–¥–∞–π `.env.local.example` –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û:
```
VITE_HA_URL=http://homeassistant.local:8123
VITE_HA_TOKEN=your_long_lived_access_token
VITE_GEMINI_API_KEY=your_gemini_api_key
```
- ‚úÖ –î–æ–±–∞–≤—å `.env` –≤ `.gitignore`
- ‚úÖ –û–±–Ω–æ–≤–∏ README —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

#### 5. **–û–ë–†–ê–ë–û–¢–ö–ê –û–®–ò–ë–û–ö**
- ‚úÖ –°–æ–∑–¥–∞–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `ErrorBoundary.tsx`
- ‚úÖ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –æ–±–µ—Ä–Ω–∏ –≤ –Ω–µ–≥–æ:
  - `App.tsx` (–∫–æ—Ä–Ω–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç)
  - `TabContent` (–æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç)
  - `DeviceCard` (–∫–∞—Ä—Ç–æ—á–∫–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤)
- ‚úÖ –î–æ–±–∞–≤—å fallback UI —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
- ‚úÖ –õ–æ–≥–∏—Ä—É–π –æ—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª—å

#### 6. **–ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π `React.memo` –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∫–∞—Ä—Ç–æ—á–µ–∫
- ‚úÖ –ü—Ä–∏–º–µ–Ω—è–π `useCallback` –¥–ª—è –≤—Å–µ—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
- ‚úÖ –†–µ–∞–ª–∏–∑—É–π lazy loading –¥–ª—è –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
- ‚úÖ –ú–µ–º–æ–∏–∑–∏—Ä—É–π –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ `useMemo`

#### 7. **–ö–û–î–°–¢–ê–ô–õ –ò –°–¢–†–£–ö–¢–£–†–ê**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å TypeScript
- ‚úÖ –î–æ–±–∞–≤–ª—è–π JSDoc –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º –∏ —Å–ª–æ–∂–Ω—ã–º –ª–æ–≥–∏–∫–∞–º
- ‚úÖ –†–∞–∑–¥–µ–ª—è–π –ª–æ–≥–∏–∫—É –∏ UI (store vs components)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π kebab-case –¥–ª—è —Ñ–∞–π–ª–æ–≤: `device-card.tsx`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π PascalCase –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤: `DeviceCard`

#### 8. **–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ò –ü–†–û–í–ï–†–ö–ê**
–ü–µ—Ä–µ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ–º –∑–∞–¥–∞—á–∏ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û:
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö –∏–º–ø–æ—Ä—Ç–æ–≤
- ‚úÖ –£–±–µ–¥–∏—Å—å, —á—Ç–æ –Ω–µ—Ç TypeScript –æ—à–∏–±–æ–∫
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å —Ä–∞–±–æ—Ç—É –≤ dev —Ä–µ–∂–∏–º–µ (`npm run dev`)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
- ‚úÖ –£–±–µ–¥–∏—Å—å, —á—Ç–æ –ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—É—Å—Ç–æ–π —ç–∫—Ä–∞–Ω

## üö® –ß–ï–ì–û –ù–ò–ö–û–ì–î–ê –ù–ï –î–ï–õ–ê–¢–¨

‚ùå **–ù–ï** —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π React 19+ (–Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è –≤–µ—Ä—Å–∏—è)
‚ùå **–ù–ï** –æ—Å—Ç–∞–≤–ª—è–π –ø—É—Å—Ç—É—é –ø–µ—Ä–≤—É—é –≤–∫–ª–∞–¥–∫—É
‚ùå **–ù–ï** —Ñ–∏–ª—å—Ç—Ä—É–π `DeviceType.Unknown` —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
‚ùå **–ù–ï** –∑–∞–±—ã–≤–∞–π –ø—Ä–æ `.env` —Ñ–∞–π–ª—ã
‚ùå **–ù–ï** –æ—Å—Ç–∞–≤–ª—è–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –±–µ–∑ Error Boundaries
‚ùå **–ù–ï** –∏—Å–ø–æ–ª—å–∑—É–π `any` –≤ TypeScript (–∏—Å–ø–æ–ª—å–∑—É–π `unknown` + type guards)
‚ùå **–ù–ï** –∫–æ–º–º–∏—Ç—å `.env` —Ñ–∞–π–ª—ã –≤ git

## üìñ –ü–†–û–¶–ï–°–° –†–ê–ë–û–¢–´

–ö–æ–≥–¥–∞ —è –¥–∞—é —Ç–µ–±–µ –∑–∞–¥–∞—á—É, —Ç—ã –î–û–õ–ñ–ï–ù:

1. **–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å** –∫–æ–¥ (—á–µ—Ä–µ–∑ view_repo_map, —á—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤)
2. **–°–æ–∑–¥–∞—Ç—å –ø–ª–∞–Ω** —Å —á–µ–∫-–ª–∏—Å—Ç–æ–º –∏–∑ –º–æ–∏—Ö –ø—Ä–∞–≤–∏–ª
3. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å** –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ –æ–¥–Ω–æ–º—É –ø—É–Ω–∫—Ç—É –∑–∞ —Ä–∞–∑
4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å** –∫–∞–∂–¥–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ
5. **–û—Ç—á–∏—Ç–∞—Ç—å—Å—è** –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–∫–∞—Ö

## üìù –§–û–†–ú–ê–¢ –û–¢–í–ï–¢–ê

–ö–æ–≥–¥–∞ —Ç—ã –æ—Ç–≤–µ—á–∞–µ—à—å, –∏—Å–ø–æ–ª—å–∑—É–π:

```
## –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã
[–û–ø–∏—Å–∞–Ω–∏–µ –≤—ã—è–≤–ª–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º]

## –ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- [ ] –ü—É–Ω–∫—Ç 1 (–ø—Ä–∞–≤–∏–ª–æ #X)
- [ ] –ü—É–Ω–∫—Ç 2 (–ø—Ä–∞–≤–∏–ª–æ #Y)

## –†–µ–∞–ª–∏–∑–∞—Ü–∏—è
[–ö–æ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–π]

## –ü—Ä–æ–≤–µ—Ä–∫–∞
‚úÖ –ó–∞–ø—É—Å—Ç–∏–ª dev —Å–µ—Ä–≤–µ—Ä - —Ä–∞–±–æ—Ç–∞–µ—Ç
‚úÖ –ü—Ä–æ–≤–µ—Ä–∏–ª –∫–æ–Ω—Å–æ–ª—å - –æ—à–∏–±–æ–∫ –Ω–µ—Ç
‚úÖ –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ - —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
```

–¢–µ–ø–µ—Ä—å —Ç—ã –ø–æ–Ω–∏–º–∞–µ—à—å –≤—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è. –ü—Ä–∏—Å—Ç—É–ø–∞–π –∫ —Ä–∞–±–æ—Ç–µ.